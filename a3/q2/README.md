# Lennard Jones System - Constant Temperature and Pressure (NPT)

## Initial Configuration

Initial configuration of position and momenta can be generated by sampling from uniform and normal distribution respectively. In the case of position however, merely sampling in $[0, L]$ does not suffice. We will have to reject samples that lead to overlap with other atoms (or the "permissible distance" in the plots) and sample again.

![initial-distances.png](initial-distances.png)

![initial-momenta.png](initial-momenta.png)

The distribution of magnitude of momenta sampled this way roughly resembles the Maxwell-Boltzmann distribution, as one would expect ([source](https://physics.stackexchange.com/a/536497)).

![initial-momenta-magnitude.png](initial-momenta-magnitude.png)

## Minimization of Potential Energy

The randomly generated configurations can be improved upon by the use of gradient based minimization on the potential energy surface.

![descent.png](descent.png)

## NPT Simulation Trajectory

Hamilton's equation coupled with Parrinello-Rahman Barostat and Nose-Hoover Thermostat were applied on the optimized configuration to generate a trajectory.

The evolution of momenta was as follows. We observe it follows the same properties as it did in the case of a single one dimensional particle, i.e. first and second moment close to zero and proportional to temperature respectively.

![momenta.png](momenta.png)

![momenta-square.png](momenta-square.png)

The evolution of energy metrics were as follows.

![kinetic-energy.png](kinetic-energy.png)

![potential-energy.png](potential-energy.png)

![total-energy.png](total-energy.png)

Based on the plots of energy and momenta, we can argue that the objective of constant temperature simulation was achieved to a reasonable extent.

The evolution of instantaneous pressure was as follows.

![pressure.png](pressure.png)

Based on the plot of pressure, we can argue that the objective of constant pressure simulation was achieved to a reasonable extent.
